import hashlib
from Crypto.Util.number import isPrime, inverse, getPrime
from Crypto.PublicKey import RSA

def get_next_prime(n):
    if n % 2 == 0: n += 1
    while not isPrime(n):
        n += 2
    return n

# 1. Формируем зерно на основе имени админа
username = "admin"
seed_pattern = f"{username}_lovenote_2026_valentine" #

# 2. Находим p
seed1_hash = hashlib.sha256(seed_pattern.encode()).digest()
start_p = int.from_bytes(seed1_hash, 'big')
p = get_next_prime(start_p)

# 3. Находим q
seed2_input = seed_pattern.encode() + b"pki" #
seed2_hash = hashlib.sha256(seed2_input).digest()
start_q = int.from_bytes(seed2_hash, 'big')
q = get_next_prime(start_q)

# 4. Собираем RSA ключ
n = p * q
e = 65537
phi = (p - 1) * (q - 1)
d = inverse(e, phi)

# Создаем объект ключа и выводим его в формате PEM
key = RSA.construct((n, e, d, p, q))
print(key.export_key().decode())
